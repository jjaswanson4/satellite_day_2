---

- name: publish new content views with the latest content
  hosts:
    - satellite
  gather_facts: false
  pre_tasks:
    - name: load in satellite vars
      include_vars:
        file: vars/satellite.yml
  tasks:
    - name: publish new content views
      block:
        - name: get all products
          redhat.satellite.resource_info:
            resource: products
            organization: "{{ satellite.organization }}"
          register: products
        - debug:
            msg: "{{ product.label }}"
          when:
            - product.repositoy_count | int >= 1
          loop_control:
            loop_var: product
          loop: "{{ products }}"


      delegate_to: localhost
